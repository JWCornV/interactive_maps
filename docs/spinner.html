<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Name Picker</title>
<style>
  :root {
    --bg: #0f172a;        /* slate-900 */
    --panel: #111827;     /* gray-900 */
    --text: #e5e7eb;      /* gray-200 */
    --accent: #60a5fa;    /* blue-400 */
    --accent-2:#34d399;   /* green-400 */
  }
  html, body { height:100%; margin:0; background:var(--bg); color:var(--text); font-family: system-ui,Segoe UI,Roboto,Inter,Arial,sans-serif; }
  .wrap { max-width: 760px; margin: 4rem auto; padding: 0 1rem; }
  h1 { font-weight: 700; letter-spacing: .2px; margin: 0 0 1rem; }
  .config {
    display:grid; gap:1rem; grid-template-columns: 1fr;
    background: var(--panel); border:1px solid #1f2937; border-radius: 16px; padding: 1rem;
  }
  .config textarea {
    width:100%; min-height:120px; resize:vertical; box-sizing:border-box;
    background:#0b1220; color:var(--text); border:1px solid #1f2937; border-radius: 10px; padding:.75rem; line-height:1.4;
  }
  .controls { display:flex; gap:.75rem; flex-wrap:wrap; align-items:center; }
  .controls label { font-size:.9rem; opacity:.9; }
  .controls input[type="number"] {
    width:6rem; background:#0b1220; color:var(--text); border:1px solid #1f2937; border-radius:8px; padding:.4rem .6rem;
  }
  button {
    appearance:none; cursor:pointer; border:0; border-radius:999px; padding:.7rem 1.1rem;
    font-weight:700; color:#0b1220; background:linear-gradient(135deg,var(--accent),var(--accent-2));
    transition: transform .08s ease, filter .2s ease;
  }
  button:disabled { opacity:.6; cursor:not-allowed; filter:grayscale(.2); }
  button:active { transform: translateY(1px) scale(.99); }

  /* Display slot */
  .display {
    margin-top: 1.25rem; position:relative; height:96px; overflow:hidden;
    border-radius: 14px; border:1px solid #1f2937; background:#0b1220;
    box-shadow: inset 0 0 0 1px rgba(255,255,255,0.02);
  }
  .window {
    position:absolute; inset:0; display:flex; align-items:center; justify-content:center;
    font-size: 2rem; font-weight: 800; letter-spacing:.3px;
  }

  /* Visual “scanner” lines */
  .display::before, .display::after {
    content:""; position:absolute; left:0; right:0; height:2px; background:rgba(255,255,255,.08);
  }
  .display::before { top: 12px; } .display::after { bottom: 12px; }
  .sub { margin-top:.5rem; font-size:.9rem; opacity:.8; }

  .result {
    margin-top: 1rem; font-size:1rem; opacity:.95;
  }
  .result strong { color: var(--accent-2); }
</style>
</head>
<body>
  <div class="wrap">
    <h1>Random Name Picker</h1>
    <div class="config">
      <label for="names">Names (one per line)</label>
      <textarea id="names" spellcheck="false">Ada
Grace
Linus
Guido
Margaret
Donald
Barbara
Tim
Ken
Bjarne
James
Anders</textarea>

      <div class="controls">
        <button id="spinBtn">Spin</button>
        <label>Spin time (sec): <input id="duration" type="number" min="1" max="30" step="0.5" value="5"></label>
        <label>Min speed (ms): <input id="minDelay" type="number" min="10" max="200" step="5" value="35"></label>
        <label>Max speed (ms): <input id="maxDelay" type="number" min="50" max="800" step="10" value="320"></label>
      </div>

      <div class="display" aria-live="polite" aria-atomic="true">
        <div class="window" id="window">Ready</div>
      </div>
      <div class="sub">Click Spin to shuffle through names and land on a random winner.</div>
      <div class="result" id="result"></div>
    </div>
  </div>

<script>
(function(){
  const el = {
    ta: document.getElementById('names'),
    btn: document.getElementById('spinBtn'),
    win: document.getElementById('window'),
    res: document.getElementById('result'),
    dur: document.getElementById('duration'),
    min: document.getElementById('minDelay'),
    max: document.getElementById('maxDelay')
  };

  function getNames() {
    return el.ta.value
      .split(/\r?\n/)
      .map(s => s.trim())
      .filter(Boolean);
  }

  // Easing: easeOutCubic for nice deceleration
  function easeOutCubic(t){ return 1 - Math.pow(1 - t, 3); }

  function chooseRandom(arr){
    // cryptographically stronger randomness if available
    if (window.crypto && crypto.getRandomValues) {
      const buf = new Uint32Array(1);
      crypto.getRandomValues(buf);
      return arr[buf[0] % arr.length];
    }
    return arr[Math.floor(Math.random()*arr.length)];
  }

  async function spin() {
    let names = getNames();
    if (names.length < 2) {
      alert('Please provide at least two names.');
      return;
    }

    // Target winner picked up-front (kept secret until end)
    const winner = chooseRandom(names);

    const duration = Math.max(1, parseFloat(el.dur.value)) * 1000; // ms
    const minDelay = Math.max(5, parseInt(el.min.value,10));       // ms between changes at max speed
    const maxDelay = Math.max(minDelay+10, parseInt(el.max.value,10)); // ms at slowest speed

    el.btn.disabled = true;
    el.res.textContent = '';
    const start = performance.now();

    // Shuffle copy for variety while spinning
    names = names.slice();
    for (let i = names.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [names[i], names[j]] = [names[j], names[i]];
    }

    let idx = 0;
    let lastTick = 0;

    return new Promise(resolve => {
      function tick(now){
        const t = Math.min(1, (now - start) / duration);   // 0..1
        const eased = easeOutCubic(t);                     // 0..1 (slow down)
        // Interpolate delay: fast at start (minDelay), slow near end (maxDelay)
        const delay = minDelay + (maxDelay - minDelay) * eased;

        if (now - lastTick >= delay) {
          el.win.textContent = names[idx % names.length];
          idx++;
          lastTick = now;
        }

        if (t < 1) {
          requestAnimationFrame(tick);
        } else {
          // Land on the winner cleanly
          el.win.textContent = winner;
          el.res.innerHTML = `Winner: <strong>${escapeHtml(winner)}</strong>`;
          el.btn.disabled = false;
          resolve(winner);
        }
      }
      requestAnimationFrame(tick);
    });
  }

  function escapeHtml(s){
    return s.replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]));
  }

  el.btn.addEventListener('click', spin);
})();
</script>
</body>
</html>
